# SIEM Windows Agent

Windows –∞–≥–µ–Ω—Ç –¥–ª—è —Å–±–æ—Ä–∞ —Å–æ–±—ã—Ç–∏–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ SIEM —Å–∏—Å—Ç–µ–º—É.

## üéØ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –°–±–æ—Ä —Å–æ–±—ã—Ç–∏–π
- **Windows Event Log**: Security, System, Application
- **Sysmon**: –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤, —Å–µ—Ç–∏, —Ñ–∞–π–ª–æ–≤
- **PowerShell**: Script Block Logging, Module Logging
- **–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π –≤ –µ–¥–∏–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç

### –ò–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏—è
- **–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–µ –ü–û**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–±–æ—Ä –∏–∑ —Ä–µ–µ—Å—Ç—Ä–∞
- **–°–ª—É–∂–±—ã Windows**: –°—Ç–∞—Ç—É—Å, —Ç–∏–ø –∑–∞–ø—É—Å–∫–∞, —É—á–µ—Ç–Ω–∞—è –∑–∞–ø–∏—Å—å
- **–ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- **Batch-–æ—Ç–ø—Ä–∞–≤–∫–∞**: –ù–∞–∫–æ–ø–ª–µ–Ω–∏–µ –∏ –æ—Ç–ø—Ä–∞–≤–∫–∞ –ø–∞–∫–µ—Ç–∞–º–∏
- **–ü—Ä–∏–æ—Ä–∏—Ç–µ–∑–∞—Ü–∏—è**: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Å–æ–±—ã—Ç–∏—è –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ
- **–°–∂–∞—Ç–∏–µ**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ gzip –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ —Ç—Ä–∞—Ñ–∏–∫–∞
- **Retry logic**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ –ø—Ä–∏ —Å–±–æ—è—Ö

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
- **Windows Service**: –†–∞–±–æ—Ç–∞ –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ
- **Heartbeat**: –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: –î–µ—Ç–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏ —Ä–∞–±–æ—Ç—ã –∞–≥–µ–Ω—Ç–∞
- **Graceful shutdown**: –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –æ—á–µ—Ä–µ–¥–∏

---

## üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
- **–û–°**: Windows 10/11, Windows Server 2016+
- **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**: x64
- **RAM**: –ú–∏–Ω–∏–º—É–º 128 MB
- **CPU**: 1 core (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 2+)
- **–î–∏—Å–∫**: 100 MB —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞

### –ü—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ
- **Go**: 1.21 –∏–ª–∏ –Ω–æ–≤–µ–µ (–¥–ª—è —Å–±–æ—Ä–∫–∏)
- **Sysmon**: –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- **SIEM Backend**: –†–∞–∑–≤–µ—Ä–Ω—É—Ç—ã–π –∏ –¥–æ—Å—Ç—É–ø–Ω—ã–π SIEM —Å–µ—Ä–≤–µ—Ä

### –°–µ—Ç–µ–≤—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
- –î–æ—Å—Ç—É–ø –∫ SIEM API –ø–æ HTTP/HTTPS
- –ò—Å—Ö–æ–¥—è—â–∏–π —Ç—Ä–∞—Ñ–∏–∫: TCP –ø–æ—Ä—Ç 8000 (–∏–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π)
- Bandwidth: ~1-10 –ú–±/—á–∞—Å (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏)

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –°–±–æ—Ä–∫–∞ –∞–≥–µ–Ω—Ç–∞

```batch
REM –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π (–µ—Å–ª–∏ –µ—â–µ –Ω–µ —Å–¥–µ–ª–∞–Ω–æ)
git clone <repository-url>
cd SIEM_FONT/agent

REM –°–æ–±—Ä–∞—Ç—å –∞–≥–µ–Ω—Ç
build.bat
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞

```batch
REM –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
copy config.yaml.example config.yaml

REM –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å config.yaml
notepad config.yaml
```

**–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**
```yaml
siem:
  server_url: "http://your-siem-server:8000"
  api_key: "your-api-key-here"
  agent_name: "WS-001"
```

### 3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```batch
REM –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤ –∫–æ–Ω—Å–æ–ª—å–Ω–æ–º —Ä–µ–∂–∏–º–µ (–¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏)
bin\siem-agent.exe -console

REM Ctrl+C –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏
```

### 4. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–∞–∫ —Å–ª—É–∂–±—ã

```batch
REM –¢—Ä–µ–±—É—é—Ç—Å—è –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
build.bat install

REM –ò–ª–∏ –≤—Ä—É—á–Ω—É—é:
bin\siem-agent.exe -install
sc start siem-agent
```

---

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

```yaml
siem:
  # URL SIEM backend API
  server_url: "http://localhost:8000"

  # API –∫–ª—é—á –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
  api_key: ""

  # –ò–º—è –∞–≥–µ–Ω—Ç–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: hostname)
  agent_name: ""

  # –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
  register_on_startup: true

  # Heartbeat –∏–Ω—Ç–µ—Ä–≤–∞–ª (—Å–µ–∫—É–Ω–¥—ã)
  heartbeat_interval: 60

  # –†–∞–∑–º–µ—Ä –±–∞—Ç—á–∞ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏
  batch_size: 100

  # –¢–∞–π–º–∞—É—Ç –æ—Ç–ø—Ä–∞–≤–∫–∏ (—Å–µ–∫—É–Ω–¥—ã)
  send_timeout: 30

  # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫
  retry_attempts: 3

  # –ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –ø–æ–ø—ã—Ç–∫–∞–º–∏ (—Å–µ–∫—É–Ω–¥—ã)
  retry_delay: 5

  # –ü—Ä–æ–ø—É—Å–∫–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
  insecure_skip_verify: false
```

### Windows Event Log

```yaml
eventlog:
  enabled: true

  channels:
    security:
      enabled: true
      name: "Security"

    system:
      enabled: true
      name: "System"

    sysmon:
      enabled: true
      name: "Microsoft-Windows-Sysmon/Operational"

    powershell:
      enabled: true
      name: "Microsoft-Windows-PowerShell/Operational"

  # –ò—Å–∫–ª—é—á–∏—Ç—å Event IDs (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)
  exclude_event_ids: []
```

### Sysmon

```yaml
sysmon:
  enabled: true

  # –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è (–æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ)
  priority_events:
    - 1   # Process creation
    - 3   # Network connection
    - 7   # Image loaded
    - 8   # CreateRemoteThread
    - 10  # ProcessAccess
    - 11  # FileCreate
    - 22  # DNS query
```

### –ò–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏—è

```yaml
inventory:
  enabled: true

  # –ò–Ω—Ç–µ—Ä–≤–∞–ª —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è (—Å–µ–∫—É–Ω–¥—ã)
  scan_interval: 3600  # 1 —á–∞—Å

  # –°–æ–±–∏—Ä–∞—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–µ –ü–û
  collect_software: true

  # –°–æ–±–∏—Ä–∞—Ç—å —Å–ª—É–∂–±—ã Windows
  collect_services: true
```

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

```yaml
performance:
  # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –æ—á–µ—Ä–µ–¥–∏
  max_queue_size: 10000

  # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CPU (%)
  max_cpu_percent: 50

  # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ RAM (MB)
  max_memory_mb: 512

  # –í–æ—Ä–∫–µ—Ä—ã –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏
  send_workers: 3
```

---

## üìä –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–ª—É–∂–±–æ–π

### –ö–æ–º–∞–Ω–¥—ã —Å–ª—É–∂–±—ã

```batch
REM –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–ª—É–∂–±—É
sc start siem-agent

REM –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–ª—É–∂–±—É
sc stop siem-agent

REM –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
sc query siem-agent

REM –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–ª—É–∂–±—É
sc stop siem-agent
timeout /t 3
sc start siem-agent

REM –£–¥–∞–ª–∏—Ç—å —Å–ª—É–∂–±—É
bin\siem-agent.exe -uninstall
```

### –ö–æ–º–∞–Ω–¥—ã –∞–≥–µ–Ω—Ç–∞

```batch
REM –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–∞–∫ —Å–ª—É–∂–±—É
siem-agent.exe -install

REM –£–¥–∞–ª–∏—Ç—å —Å–ª—É–∂–±—É
siem-agent.exe -uninstall

REM –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–ª—É–∂–±—É (—Ç—Ä–µ–±—É–µ—Ç –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏)
siem-agent.exe -start

REM –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–ª—É–∂–±—É
siem-agent.exe -stop

REM –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–ª—É–∂–±—É
siem-agent.exe -restart

REM –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤ –∫–æ–Ω—Å–æ–ª—å–Ω–æ–º —Ä–µ–∂–∏–º–µ (–¥–ª—è –æ—Ç–ª–∞–¥–∫–∏)
siem-agent.exe -console

REM –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç—É—Å —Å–ª—É–∂–±—ã
siem-agent.exe -status

REM –ü–æ–∫–∞–∑–∞—Ç—å –≤–µ—Ä—Å–∏—é
siem-agent.exe -version
```

---

## üìù –õ–æ–≥–∏

### –†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –ª–æ–≥–æ–≤

- **–°–ª—É–∂–±–∞**: `C:\ProgramData\SIEM\logs\agent.log`
- **Console mode**: –í—ã–≤–æ–¥ –≤ –∫–æ–Ω—Å–æ–ª—å

### –£—Ä–æ–≤–Ω–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

–í `config.yaml`:
```yaml
logging:
  level: "info"  # debug, info, warning, error
  file: "C:\\ProgramData\\SIEM\\logs\\agent.log"
  max_size_mb: 100
  max_backups: 5
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤

```batch
REM –û—Ç–∫—Ä—ã—Ç—å –ª–æ–≥-—Ñ–∞–π–ª
notepad C:\ProgramData\SIEM\logs\agent.log

REM –ü–æ—Å–ª–µ–¥–Ω–∏–µ 50 —Å—Ç—Ä–æ–∫
powershell Get-Content C:\ProgramData\SIEM\logs\agent.log -Tail 50

REM –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
powershell Get-Content C:\ProgramData\SIEM\logs\agent.log -Wait -Tail 20
```

---

## üîç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### Event Viewer

–°–æ–±—ã—Ç–∏—è –∞–≥–µ–Ω—Ç–∞ –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –≤ Windows Event Viewer:
- **Application Log** ‚Üí Source: `siem-agent`

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∞–≥–µ–Ω—Ç–∞

–í –ª–æ–≥–∞—Ö –∞–≥–µ–Ω—Ç –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –≤—ã–≤–æ–¥–∏—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É:
```
[INFO] Agent Statistics:
  - Events collected: 1523
  - Events sent: 1500
  - Events queued: 23
  - Inventory items: 245
  - Uptime: 3h 25m
  - Last heartbeat: OK
```

### SIEM Dashboard

–°—Ç–∞—Ç—É—Å –∞–≥–µ–Ω—Ç–∞ –º–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á–µ—Ä–µ–∑ SIEM web-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å:
- **Agents** ‚Üí –ù–∞–π—Ç–∏ –∞–≥–µ–Ω—Ç –ø–æ hostname
- –°—Ç–∞—Ç—É—Å: online/offline
- –ü–æ—Å–ª–µ–¥–Ω–∏–π heartbeat
- –°–æ–±—Ä–∞–Ω–æ —Å–æ–±—ã—Ç–∏–π
- –í–µ—Ä—Å–∏—è –∞–≥–µ–Ω—Ç–∞

---

## üêõ Troubleshooting

### –ê–≥–µ–Ω—Ç –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

**–ü—Ä–æ–±–ª–µ–º–∞**: –°–ª—É–∂–±–∞ –Ω–µ —Å—Ç–∞—Ä—Ç—É–µ—Ç –∏–ª–∏ –ø–∞–¥–∞–µ—Ç —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞

**–†–µ—à–µ–Ω–∏–µ**:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `C:\ProgramData\SIEM\logs\agent.log`
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –≤ –∫–æ–Ω—Å–æ–ª—å–Ω–æ–º —Ä–µ–∂–∏–º–µ: `siem-agent.exe -console`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `config.yaml` –Ω–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏
4. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ SIEM —Å–µ—Ä–≤–µ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω

### –°–æ–±—ã—Ç–∏—è –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è

**–ü—Ä–æ–±–ª–µ–º–∞**: –ê–≥–µ–Ω—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ —Å–æ–±—ã—Ç–∏—è –Ω–µ –ø–æ—è–≤–ª—è—é—Ç—Å—è –≤ SIEM

**–†–µ—à–µ–Ω–∏–µ**:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ SIEM:
   ```batch
   curl http://siem-server:8000/api/v1/health
   ```
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ API key –≤ `config.yaml`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ firewall:
   ```batch
   Test-NetConnection siem-server -Port 8000
   ```
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –∞–≥–µ–Ω—Ç–∞ –Ω–∞ –æ—à–∏–±–∫–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏

### –í—ã—Å–æ–∫–æ–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤

**–ü—Ä–æ–±–ª–µ–º–∞**: –ê–≥–µ–Ω—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–Ω–æ–≥–æ CPU –∏–ª–∏ RAM

**–†–µ—à–µ–Ω–∏–µ**:
1. –£–º–µ–Ω—å—à–∏—Ç–µ `batch_size` –≤ config.yaml
2. –£–≤–µ–ª–∏—á—å—Ç–µ `heartbeat_interval`
3. –û—Ç–∫–ª—é—á–∏—Ç–µ –Ω–µ–Ω—É–∂–Ω—ã–µ –∫–∞–Ω–∞–ª—ã Event Log
4. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ª–∏–º–∏—Ç—ã –≤ `performance` —Å–µ–∫—Ü–∏–∏
5. –î–æ–±–∞–≤—å—Ç–µ Event IDs –≤ `exclude_event_ids`

### Sysmon —Å–æ–±—ã—Ç–∏—è –Ω–µ —Å–æ–±–∏—Ä–∞—é—Ç—Å—è

**–ü—Ä–æ–±–ª–µ–º–∞**: –°–æ–±—ã—Ç–∏—è Sysmon –Ω–µ –ø–æ—è–≤–ª—è—é—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ**:
1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Sysmon —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω:
   ```batch
   sc query Sysmon64
   ```
2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Sysmon:
   ```batch
   sysmon64.exe -accepteula -i sysmonconfig.xml
   ```
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–º—è –∫–∞–Ω–∞–ª–∞ –≤ config.yaml:
   ```yaml
   sysmon:
     enabled: true
     name: "Microsoft-Windows-Sysmon/Operational"
   ```

### –û—à–∏–±–∫–∞ "Access Denied"

**–ü—Ä–æ–±–ª–µ–º–∞**: –ê–≥–µ–Ω—Ç –Ω–µ –º–æ–∂–µ—Ç —á–∏—Ç–∞—Ç—å Security Log

**–†–µ—à–µ–Ω–∏–µ**:
1. –°–ª—É–∂–±–∞ –¥–æ–ª–∂–Ω–∞ —Ä–∞–±–æ—Ç–∞—Ç—å –ø–æ–¥ `SYSTEM` –∏–ª–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ —Å–ª—É–∂–±—ã:
   ```batch
   sc qc siem-agent
   ```
3. –ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å–ª—É–∂–±—É —Å –ø—Ä–∞–≤–∞–º–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

---

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –•—Ä–∞–Ω–µ–Ω–∏–µ API –∫–ª—é—á–∞

- API –∫–ª—é—á —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ `config.yaml` –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ
- –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤:
  ```batch
  icacls config.yaml /inheritance:r /grant Administrators:F SYSTEM:F
  ```

### Network Security

- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ HTTPS –¥–ª—è SIEM API –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã:
  ```yaml
  siem:
    server_url: "https://siem-server:8443"
    insecure_skip_verify: false
  ```

### Firewall Rules

```batch
REM –†–∞–∑—Ä–µ—à–∏—Ç—å –∏—Å—Ö–æ–¥—è—â–∏–π —Ç—Ä–∞—Ñ–∏–∫ –∫ SIEM
netsh advfirewall firewall add rule name="SIEM Agent" dir=out action=allow program="C:\Path\To\siem-agent.exe" enable=yes
```

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [Sysmon Configuration](https://github.com/SwiftOnSecurity/sysmon-config)
- [Windows Event IDs](https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/)
- [MITRE ATT&CK](https://attack.mitre.org/)

---

## ü§ù –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –∞–≥–µ–Ω—Ç–∞
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –≤ –∫–æ–Ω—Å–æ–ª—å–Ω–æ–º —Ä–µ–∂–∏–º–µ —Å `debug` —É—Ä–æ–≤–Ω–µ–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é SIEM Backend
4. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞

---

**–í–µ—Ä—Å–∏—è**: 1.0.0
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: 2025-01-01
