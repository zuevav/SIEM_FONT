# =====================================================================
# SIEM SYSTEM - ENVIRONMENT VARIABLES
# =====================================================================
# Скопируйте этот файл в .env и заполните реальными значениями
# cp .env.example .env
# =====================================================================

# =====================================================================
# DATABASE CONFIGURATION
# =====================================================================
# Тип БД: postgresql (рекомендуется) или mssql (legacy)
DATABASE_TYPE=postgresql

# PostgreSQL 15 + TimescaleDB (RECOMMENDED)
POSTGRES_HOST=postgres
POSTGRES_PORT=5432
POSTGRES_DB=siem_db
POSTGRES_USER=siem_app
POSTGRES_PASSWORD=ChangeMeInProduction123!
POSTGRES_SSLMODE=prefer

# PostgreSQL superuser (для Docker инициализации)
POSTGRES_SUPERUSER=postgres
POSTGRES_SUPERUSER_PASSWORD=PostgresAdminPassword123!

# MS SQL SERVER (LEGACY SUPPORT)
MSSQL_ENABLED=false
MSSQL_SERVER=localhost
MSSQL_PORT=1433
MSSQL_DATABASE=SIEM_DB
MSSQL_USER=siem_app
MSSQL_PASSWORD=YourStrongPasswordHere
MSSQL_DRIVER=ODBC Driver 18 for SQL Server
MSSQL_TRUST_CERT=yes

# Connection pool (для обоих типов БД)
DATABASE_POOL_SIZE=20
DATABASE_MAX_OVERFLOW=10
DATABASE_POOL_TIMEOUT=30
DATABASE_POOL_RECYCLE_SEC=3600

# =====================================================================
# AI PROVIDER (DeepSeek / Yandex GPT / OpenAI)
# =====================================================================
AI_ENABLED=true
AI_PROVIDER=deepseek
# AI_PROVIDER options: deepseek, yandex_gpt, openai

# DeepSeek (RECOMMENDED - дешевле, хорошее качество)
DEEPSEEK_API_KEY=your_deepseek_api_key_here
DEEPSEEK_API_URL=https://api.deepseek.com/v1/chat/completions
DEEPSEEK_MODEL=deepseek-chat
DEEPSEEK_TEMPERATURE=0.3
DEEPSEEK_MAX_TOKENS=2000

# Yandex GPT (для российских организаций)
# Получить ключи: https://cloud.yandex.ru/docs/iam/operations/api-key/create
YANDEX_GPT_API_KEY=AQVN...your_api_key_here
YANDEX_GPT_FOLDER_ID=b1g...your_folder_id
YANDEX_GPT_API_URL=https://llm.api.cloud.yandex.net/foundationModels/v1/completion
YANDEX_GPT_MODEL=yandexgpt-lite
# yandexgpt-lite - дешевле, быстрее (рекомендуется для production)
# yandexgpt - точнее, но дороже

# OpenAI (если есть доступ)
OPENAI_API_KEY=your_openai_api_key_here
OPENAI_MODEL=gpt-4
OPENAI_TEMPERATURE=0.3

# AI Processing Parameters
AI_TEMPERATURE=0.3
AI_MAX_TOKENS=2000
AI_TIMEOUT=30
AI_BATCH_SIZE=10
AI_PROCESS_INTERVAL_SEC=60
AI_RETRY_ATTEMPTS=3
AI_FALLBACK_TO_RULES=true

# =====================================================================
# APPLICATION SETTINGS
# =====================================================================
APP_NAME=SIEM System
APP_VERSION=1.0.0
APP_ENV=development
# development, staging, production

# API
API_HOST=0.0.0.0
API_PORT=8000
API_WORKERS=4
API_RELOAD=true
# В production установите API_RELOAD=false

# CORS (разрешённые источники для frontend)
CORS_ORIGINS=http://localhost:3000,http://localhost:5173,http://localhost:8080

# =====================================================================
# SECURITY
# =====================================================================
# JWT (JSON Web Tokens)
JWT_SECRET_KEY=change_me_to_random_secure_string_min_32_chars
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=480
# 480 минут = 8 часов

# Session
SESSION_TIMEOUT_MINUTES=480

# Password Policy
PASSWORD_MIN_LENGTH=12
PASSWORD_REQUIRE_UPPERCASE=true
PASSWORD_REQUIRE_LOWERCASE=true
PASSWORD_REQUIRE_DIGITS=true
PASSWORD_REQUIRE_SPECIAL=true

# Account Lockout
FAILED_LOGIN_ATTEMPTS=5
ACCOUNT_LOCKOUT_MINUTES=30

# =====================================================================
# ACTIVE DIRECTORY INTEGRATION (OPTIONAL)
# =====================================================================
AD_ENABLED=false
AD_SERVER=ldap://dc.company.local:389
AD_BASE_DN=DC=company,DC=local
AD_BIND_USER=CN=siem_service,OU=Service Accounts,DC=company,DC=local
AD_BIND_PASSWORD=ad_service_password
AD_USER_SEARCH_FILTER=(&(objectClass=user)(sAMAccountName={username}))
AD_GROUP_SEARCH_FILTER=(&(objectClass=group)(member={user_dn}))
AD_SYNC_ENABLED=false
AD_SYNC_INTERVAL_HOURS=24

# =====================================================================
# EMAIL NOTIFICATIONS
# =====================================================================
EMAIL_ENABLED=true
SMTP_SERVER=smtp.company.local
SMTP_PORT=587
SMTP_USERNAME=siem@company.local
SMTP_PASSWORD=smtp_password_here
SMTP_USE_TLS=true
SMTP_FROM_EMAIL=siem@company.local
SMTP_FROM_NAME=SIEM System

# Email Templates
EMAIL_ALERT_TEMPLATE=alert
EMAIL_INCIDENT_TEMPLATE=incident
EMAIL_REPORT_TEMPLATE=report

# Recipients
EMAIL_ADMIN_LIST=admin@company.local,security@company.local
EMAIL_ANALYST_LIST=soc@company.local

# =====================================================================
# TELEGRAM NOTIFICATIONS (OPTIONAL)
# =====================================================================
TELEGRAM_ENABLED=false
TELEGRAM_BOT_TOKEN=1234567890:ABCdefGHIjklMNOpqrsTUVwxyz
TELEGRAM_CHAT_ID=-1001234567890
# Получить chat_id: отправьте сообщение боту и вызовите getUpdates

# Telegram для критичных алертов
TELEGRAM_CRITICAL_ONLY=true
TELEGRAM_MIN_SEVERITY=3

# =====================================================================
# REDIS (CACHE & QUEUES) - OPTIONAL
# =====================================================================
REDIS_ENABLED=false
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0
REDIS_CACHE_TTL=300
# 300 секунд = 5 минут

# Redis для очередей обработки
REDIS_QUEUE_ENABLED=false
REDIS_QUEUE_NAME=siem:events

# =====================================================================
# DATA RETENTION (ЦБ РФ REQUIREMENTS)
# =====================================================================
RETENTION_DAYS=1825
# 1825 дней = 5 лет (требование ЦБ РФ 683-П)

RETENTION_ALERTS_DAYS=1825
RETENTION_AUDIT_DAYS=1825
RETENTION_INCIDENTS_DAYS=2555
# 7 лет для инцидентов

# Auto-purge settings
AUTO_PURGE_ENABLED=false
AUTO_PURGE_BATCH_SIZE=10000
AUTO_PURGE_INTERVAL_DAYS=1

# =====================================================================
# AGENT SETTINGS
# =====================================================================
AGENT_HEARTBEAT_INTERVAL_SEC=60
AGENT_OFFLINE_THRESHOLD_MINUTES=5
AGENT_CONFIG_UPDATE_ENABLED=true
AGENT_AUTO_UPDATE_ENABLED=false
# Осторожно с auto-update в production!

AGENT_MAX_BATCH_SIZE=1000
AGENT_COMPRESSION_ENABLED=true

# =====================================================================
# CBR REPORTING (ЦБ РФ)
# =====================================================================
CBR_REPORTING_ENABLED=true

# Organization Info
CBR_ORG_NAME=ООО "Название Организации"
CBR_ORG_INN=1234567890
CBR_ORG_OGRN=1234567890123
CBR_ORG_KPP=123456789
CBR_ORG_ADDRESS=г. Москва, ул. Примерная, д. 1
CBR_ORG_PHONE=+7 (495) 123-45-67
CBR_ORG_EMAIL=info@company.ru

# Contact Person
CBR_CONTACT_PERSON=Иванов Иван Иванович
CBR_CONTACT_POSITION=Руководитель службы ИБ
CBR_CONTACT_EMAIL=ivanov@company.ru
CBR_CONTACT_PHONE=+7 (495) 123-45-68

# FinCERT Integration
CBR_FINCERT_ENABLED=false
CBR_FINCERT_API_URL=https://fincert.cbr.ru/api
CBR_FINCERT_API_KEY=your_fincert_api_key
CBR_FINCERT_ORG_ID=12345

# Auto-reporting thresholds
CBR_AUTO_REPORT_ENABLED=false
CBR_AUTO_REPORT_MIN_SEVERITY=3
CBR_AUTO_REPORT_DELAY_HOURS=3
# 3 часа - требование ЦБ для уведомления

# =====================================================================
# LOGGING
# =====================================================================
LOG_LEVEL=INFO
# DEBUG, INFO, WARNING, ERROR, CRITICAL

LOG_FORMAT=json
# json или text

LOG_FILE_ENABLED=true
LOG_FILE_PATH=/var/log/siem/app.log
LOG_FILE_MAX_SIZE_MB=100
LOG_FILE_BACKUP_COUNT=10

# =====================================================================
# MONITORING & METRICS
# =====================================================================
METRICS_ENABLED=false
METRICS_PORT=9090

# Prometheus
PROMETHEUS_ENABLED=false
PROMETHEUS_MULTIPROC_DIR=/tmp/prometheus

# Health Check
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_PATH=/health

# =====================================================================
# PERFORMANCE TUNING
# =====================================================================
# Event Processing
EVENT_BATCH_SIZE=1000
EVENT_PROCESSING_THREADS=4
EVENT_QUEUE_SIZE=10000

# Query Limits
MAX_EVENTS_PER_QUERY=10000
QUERY_TIMEOUT_SEC=30

# =====================================================================
# DOCKER COMPOSE SETTINGS
# =====================================================================
COMPOSE_PROJECT_NAME=siem
RESTART_POLICY=unless-stopped
# Options: no, always, on-failure, unless-stopped

# Network
NETWORK_NAME=siem-network

# Volumes (пути для Docker volumes)
POSTGRES_DATA_PATH=./volumes/postgres
BACKEND_LOGS_PATH=./volumes/logs
BACKEND_UPLOADS_PATH=./volumes/uploads
ARCHIVE_PATH=./volumes/archive
BACKUP_PATH=./volumes/backups

# PgAdmin (опциональный веб-интерфейс для PostgreSQL)
PGADMIN_DEFAULT_EMAIL=admin@siem.local
PGADMIN_DEFAULT_PASSWORD=AdminPassword123!
PGADMIN_LISTEN_PORT=5050

# Redis (для кэширования)
REDIS_ENABLED=true
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0
REDIS_CACHE_TTL=3600

# =====================================================================
# DEVELOPMENT & DEBUG
# =====================================================================
DEBUG=false
DEBUG_SQL=false
# Включает вывод SQL запросов (только для dev!)

TESTING=false
PROFILE_ENABLED=false

# Mock Services (для тестирования)
MOCK_YANDEX_GPT=false
MOCK_EMAIL=false
MOCK_TELEGRAM=false

# =====================================================================
# FRONTEND SETTINGS (для docker-compose)
# =====================================================================
VITE_API_URL=http://localhost:8000
VITE_WS_URL=ws://localhost:8000/ws
VITE_APP_NAME=SIEM System
VITE_APP_VERSION=1.0.0

# =====================================================================
# TIMEZONE
# =====================================================================
TZ=Europe/Moscow
# Установите ваш часовой пояс

# =====================================================================
# BACKUP SETTINGS
# =====================================================================
BACKUP_ENABLED=false
BACKUP_SCHEDULE=0 2 * * 0
# Cron: каждое воскресенье в 02:00

BACKUP_PATH=/backups/siem
BACKUP_RETENTION_DAYS=30
BACKUP_COMPRESSION=true

# =====================================================================
# EXTERNAL INTEGRATIONS
# =====================================================================
# Threat Intelligence Feeds
THREAT_INTEL_ENABLED=false
THREAT_INTEL_API_KEY=your_threat_intel_key

# SIEM Integrations
SPLUNK_ENABLED=false
SPLUNK_URL=https://splunk.company.local:8089
SPLUNK_TOKEN=your_splunk_hec_token

ELK_ENABLED=false
ELK_URL=https://elasticsearch.company.local:9200
ELK_USERNAME=elastic
ELK_PASSWORD=elastic_password

# =====================================================================
# FEATURE FLAGS
# =====================================================================
FEATURE_AI_ANALYSIS=true
FEATURE_AUTO_REMEDIATION=false
FEATURE_THREAT_HUNTING=true
FEATURE_UEBA=true
# User and Entity Behavior Analytics

FEATURE_VULNERABILITY_SCAN=false
FEATURE_COMPLIANCE_SCAN=true

# =====================================================================
# RATE LIMITING
# =====================================================================
RATE_LIMIT_ENABLED=true
RATE_LIMIT_PER_MINUTE=60
RATE_LIMIT_PER_HOUR=1000

# =====================================================================
# NOTES
# =====================================================================
# ВАЖНО:
# 1. Измените все пароли и секретные ключи!
# 2. В production установите DEBUG=false
# 3. Настройте JWT_SECRET_KEY (минимум 32 символа)
# 4. Укажите реальные данные организации для отчётов ЦБ
# 5. Настройте Yandex GPT API ключи
# 6. Настройте SMTP для email уведомлений
# =====================================================================
