# Анализ рынка SIEM и отчёт о функциональных пробелах

## Краткое резюме

Этот документ анализирует текущее состояние нашей SIEM системы в сравнении с коммерческими решениями (Splunk, IBM QRadar, ArcSight, Elastic Security, Wazuh) и определяет пробелы для дальнейшего развития.

> **Связанная документация:**
> - [Руководство по быстрой установке](QUICK_INSTALL.md) - Как установить SIEM систему
> - [Руководство по настройке Phase 1](PHASE1_SETUP.md) - Конфигурация текущих функций
> - [Интеграция с FreeScout](FREESCOUT_INTEGRATION.md) - Детали интеграции с helpdesk

---

## Что у нас есть (Текущая реализация)

### Сбор данных
- **Windows Агент** - Сбор журналов событий Windows (Security, System, Application, PowerShell, Sysmon)
- **Сетевой монитор** - Поддержка SNMP, Syslog, NetFlow
- **Потоковая передача в реальном времени** - Стриминг событий через WebSocket

### Серверная инфраструктура
- **FastAPI Backend** - Высокопроизводительный Python API
- **PostgreSQL + TimescaleDB** - Хранилище, оптимизированное для временных рядов
- **Docker Compose** - Контейнеризованное развёртывание

### Детектирование и аналитика
- **Правила детекции** - 5 типов: simple, threshold, correlation, sigma, ml
- **10 базовых правил** - Brute force, PowerShell атаки, Mimikatz, ransomware и др.
- **Маппинг MITRE ATT&CK** - Все правила привязаны к тактикам/техникам
- **AI Анализ** - Интеграция DeepSeek/YandexGPT для анализа инцидентов
- **Автоматическая корреляция алертов** - По временному окну, хосту, пользователю, IP, цепочке MITRE kill chain
- **Авто-эскалация** - Критические алерты автоматически создают инциденты

### Управление инцидентами
- **Полный жизненный цикл** - open → investigating → contained → remediated → closed
- **Журнал работ** - Полный аудит действий
- **Действия по сдерживанию/устранению** - Структурированный рабочий процесс реагирования
- **Визуализация таймлайна** - Хронология событий для инцидентов
- **Отчётность ЦБ РФ** - Соответствие требованиям Центрального банка России

### Пользовательский интерфейс
- **React + TypeScript Frontend** - Современное SPA
- **Дашборд реального времени** - Живая статистика и графики
- **Тёмная/Светлая тема** - Настройка пользователя
- **Страницы событий, алертов, инцидентов, агентов** - Основной функционал
- **Расширенная фильтрация** - Многопараметрический поиск

### Безопасность и комплаенс
- **JWT Аутентификация** - Безопасный доступ к API
- **RBAC** - Роли viewer, analyst, admin
- **Соответствие ЦБ РФ** - Российские нормативы

---

## Чего нам не хватает (Функциональные пробелы)

### Критические пробелы (Обязательно для продакшена)

> **Примечание**: Фокус на Windows инфраструктуре. Агенты для Linux/macOS не требуются.

#### 1. **Интеграция с Threat Intelligence**
- **VirusTotal** - Нет проверки хэшей файлов
- **AbuseIPDB** - Нет проверки репутации IP
- **AlienVault OTX** - Нет интеграции с фидами угроз
- **MISP** - Нет платформы разведки угроз
- **Влияние**: Невозможно обогащать события контекстом угроз
- **Сравнение с коммерческими решениями**: Стандартная функция во всех SIEM

#### 2. **Автоматическое реагирование (SOAR)**
- **Playbooks** - Нет автоматизированных рабочих процессов реагирования
- **Блокировка IP/Домена** - Нет автоматической блокировки угроз
- **Изоляция хоста** - Нет карантина заражённых машин
- **Выполнение скриптов** - Нет удалённого выполнения команд
- **Влияние**: Только ручное реагирование, медленное сдерживание инцидентов
- **Сравнение с коммерческими решениями**: QRadar, Splunk SOAR, Elastic имеют полную автоматизацию

#### 3. **Email уведомления**
- **Email алертов** - Нет email при критических алертах
- **Отчёты по инцидентам** - Нет запланированных email отчётов
- **Email эскалации** - Нет цепочек уведомлений
- **Влияние**: Аналитики пропускают критические алерты
- **Сравнение с коммерческими решениями**: Базовая функция во всех SIEM

#### 4. **Интеграция с тикетами FreeScout**
- **Автоматическое создание тикетов** - Нет автосоздания тикетов из алертов/инцидентов
- **Синхронизация статуса тикетов** - Нет двусторонней синхронизации между SIEM и FreeScout
- **Обработчики Webhook** - Нет обработки webhook от FreeScout
- **Отслеживание переписки** - Невозможно отслеживать коммуникации аналитиков
- **Влияние**: Ручное создание тикетов, потерянный контекст, двойной ввод данных
- **Доступно**: FreeScout имеет API и модуль Webhooks
- **Сравнение с коммерческими решениями**: Интеграции с ServiceNow, Jira стандартны в корпоративных SIEM

#### 5. **Простая установка**
- **Установщик в один клик** - **РЕАЛИЗОВАНО** (install.sh, install.ps1)
- **Автозагрузка с GitHub** - **РЕАЛИЗОВАНО**
- **Мастер настройки** - **РЕАЛИЗОВАНО**
- ~~**Влияние**: Высокий барьер входа, медленное развёртывание~~
- **Статус**: ВЫПОЛНЕНО

---

### Высокий приоритет (Готовность к продакшену)

#### 6. **Обогащение данных**
- **GeoIP** - Нет маппинга IP → Страна/Город
- **Обратный DNS Lookup** - Нет разрешения IP → hostname
- **WHOIS** - Нет информации о владельце домена
- **Обогащение по активам** - Нет интеграции с CMDB
- **Влияние**: Ограниченный контекст для расследований

#### 7. **Мониторинг целостности файлов (FIM)**
- **Мониторинг критических файлов** - Нет отслеживания /etc/passwd, ключей реестра
- **Сравнение с базовым состоянием** - Нет сравнения до/после
- **Алерты на изменения** - Нет алертов на несанкционированные изменения
- **Влияние**: Невозможно обнаружить подмену конфигурации
- **Сравнение с коммерческими решениями**: Wazuh, OSSEC имеют встроенный FIM

#### 8. **Расширенный поиск**
- **Сохранённые поисковые запросы** - Невозможно сохранить частые запросы
- **Язык запросов** - Только базовая фильтрация
- **Закладки** - Нет сохранённых событий/алертов
- **Влияние**: Неэффективные расследования

#### 9. **Запланированные отчёты**
- **Ежедневные/Еженедельные отчёты** - Нет автоматической отчётности
- **Отчёты комплаенса** - Нет шаблонов PCI-DSS, ISO 27001
- **Экспорт в PDF** - Нет форматированных отчётов
- **Влияние**: Ручная генерация отчётов

#### 10. **Интеграция с уязвимостями**
- **Nessus/OpenVAS** - Нет интеграции со сканерами уязвимостей
- **Корреляция CVE** - Невозможно связать эксплойты с уязвимостями
- **Статус патчей** - Нет видимости управления патчами
- **Влияние**: Слепота к эксплуатации уязвимостей

---

### Средний приоритет (Корпоративные функции)

#### 11. **UEBA (Поведенческая аналитика пользователей и сущностей)**
- **Поведенческие базовые линии** - Нет моделирования нормального поведения
- **Обнаружение аномалий** - Нет ML-аномалий
- **Оценка риска** - Нет оценки риска пользователей
- **Влияние**: Невозможно обнаружить внутренние угрозы, скомпрометированные аккаунты

#### 12. **Анализ сетевого трафика (NTA)**
- **Анализ PCAP** - Нет инспекции пакетов
- **Аномалии протоколов** - Нет глубокой инспекции пакетов
- **Анализ пропускной способности** - Нет мониторинга объёма трафика

#### 13. **Графовая визуализация**
- **Пути атак** - Нет визуальных цепочек атак
- **Связи сущностей** - Нет графов хост/пользователь/IP
- **Карты латерального перемещения** - Нет сетевых графов

---

### Низкий приоритет (Желательно иметь)

#### 16. **Мультиарендность**
- **Поддержка MSSP** - Невозможно обслуживать нескольких клиентов
- **Изоляция данных** - Нет разделения арендаторов

#### 17. **Технологии обмана**
- **Honeypots** - Нет систем-ловушек
- **Honeytokens** - Нет поддельных учётных данных

#### 18. **Мобильное приложение**
- **iOS/Android** - Нет мобильного мониторинга

#### 19. **Мониторинг Даркнета**
- **Утечки учётных данных** - Нет обнаружения утечек
- **Защита бренда** - Нет обнаружения киберсквоттинга

#### 20. **Расширенная форензика**
- **Анализ памяти** - Нет интеграции с Volatility
- **Форензика дисков** - Нет интеграции с Autopsy/Sleuthkit

---

## Рекомендуемый приоритет реализации

> **Обновлённая дорожная карта**: Фокус на Windows инфраструктуре. Агенты для Linux/macOS и облачная интеграция не нужны.

### Phase 1: Продакшен MVP (2-3 недели) **ВЫСОКИЙ ПРИОРИТЕТ**
1. **Установщик в один клик** - **ВЫПОЛНЕНО**
2. **Email уведомления** - SMTP, email критических алертов, отчёты по инцидентам
3. **GeoIP обогащение** - MaxMind GeoLite2, IP → Страна/Город/ASN
4. **Threat Intelligence** - VirusTotal, AbuseIPDB, AlienVault OTX
5. **Интеграция с FreeScout** - Автосоздание тикетов, синхронизация статуса, webhooks
6. **Сохранённые поисковые запросы** - Сохранение/шаринг конфигураций фильтров

**Цель**: Готовая к продакшену SIEM для Windows инфраструктуры с полным рабочим процессом инцидентов

**Расчётное время**: 2-3 недели
**Размер команды**: 1-2 разработчика

---

### Phase 2: Автоматизация и реагирование (2-3 недели)
7. **SOAR Playbooks** - YAML-автоматизация реагирования
8. **Действия реагирования** - Блокировка IP/Домена на файрволе, изоляция хоста, отключение пользователя
9. **Запланированные отчёты** - Ежедневная/еженедельная автоматическая отчётность
10. **Мониторинг целостности файлов** - Реестр Windows, мониторинг критических файлов
11. **Расширенный поиск** - Конструктор запросов, фильтры, SPL-подобный синтаксис

**Цель**: Автоматизированное реагирование и отчётность комплаенса

**Расчётное время**: 2-3 недели
**Размер команды**: 1-2 разработчика

---

### Phase 3: Расширенная аналитика (3-4 недели)
12. **UEBA** - Базовые линии поведения пользователей, обнаружение аномалий, оценка риска
13. **Интеграция с уязвимостями** - Nessus/OpenVAS, корреляция CVE
14. **Графовая визуализация** - Пути атак, карты латерального перемещения
15. **Расширенные дашборды** - Кастомные виджеты, drill-down аналитика
16. **Инструменты форензики** - Поиск событий с контекстом, реконструкция таймлайна

**Цель**: Проактивный поиск угроз и форензик-анализ

**Расчётное время**: 3-4 недели
**Размер команды**: 2 разработчика

---

### Phase 4: Корпоративные функции (3-4 недели)
17. **Мультиарендность** - Поддержка MSSP, изоляция данных
18. **Шаблоны комплаенса** - Шаблоны отчётов PCI-DSS, ISO 27001, GDPR, ЦБ РФ
19. **Мобильное приложение** - iOS/Android для мониторинга алертов
20. **Расширенные оповещения** - Интеграции со Slack, Telegram, MS Teams

**Цель**: Корпоративная SIEM для сервис-провайдеров

**Расчётное время**: 3-4 недели
**Размер команды**: 2-3 разработчика

---

### Phase 5: Будущие улучшения (Бэклог)
21. **Технологии обмана** - Honeypots, honeytokens
22. **Мониторинг Даркнета** - Обнаружение утечек учётных данных
23. **Расширенная форензика** - Анализ памяти (Volatility), форензика дисков
24. **Облачная интеграция** - AWS CloudTrail, Azure Sentinel (при необходимости)

---

## Сравнение с коммерческими SIEM

| Функция | Наша SIEM | Splunk | QRadar | Elastic | Wazuh | Приоритет |
|---------|-----------|--------|--------|---------|-------|-----------|
| **Windows Агент** | Есть | Есть | Есть | Есть | Есть | Базовый |
| **Правила детекции** | Есть | Есть | Есть | Есть | Есть | Базовый |
| **AI Анализ** | Есть | Есть | Есть | Есть | Нет | Базовый |
| **Авто-корреляция** | Есть | Есть | Есть | Есть | Частично | Базовый |
| **Управление инцидентами** | Есть | Есть | Есть | Есть | Частично | Базовый |
| **Простая установка** | Есть | Есть | Есть | Есть | Есть | **ГОТОВО** |
| **Threat Intel** | Нет | Есть | Есть | Есть | Есть | Критический |
| **Email алерты** | Нет | Есть | Есть | Есть | Есть | Критический |
| **Тикеты FreeScout** | Нет | Частично | Частично | Частично | Нет | Критический |
| **SOAR/Playbooks** | Нет | Есть | Есть | Есть | Частично | Критический |
| **GeoIP** | Нет | Есть | Есть | Есть | Есть | Высокий |
| **FIM** | Нет | Есть | Есть | Есть | Есть | Высокий |
| **Сохранённые поиски** | Нет | Есть | Есть | Есть | Есть | Высокий |
| **UEBA** | Нет | Есть | Есть | Есть | Нет | Средний |
| **Графовая визуализация** | Нет | Есть | Есть | Есть | Нет | Средний |
| **Сканирование уязвимостей** | Нет | Есть | Есть | Есть | Есть | Средний |

**Легенда**: Есть = Полная поддержка | Частично = Частичная поддержка | Нет = Не поддерживается

**Примечание**: Агенты для Linux/macOS и облачная интеграция исключены (не входят в scope для Windows-ориентированного развёртывания)

---

## Позиционирование на рынке

### Текущее состояние
- **Сильная сторона**: SIEM с фокусом на Windows с AI анализом, авто-корреляцией и соответствием ЦБ РФ
- **Целевая аудитория**: Российские организации с Windows инфраструктурой
- **Отличительные особенности**:
  - AI-анализ инцидентов (DeepSeek/YandexGPT)
  - Автоматическая корреляция алертов
  - Современный React UI с WebSocket реального времени
  - 5-минутная установка (один клик)
  - Соответствие ЦБ РФ (683-П, 716-П, 747-П)
- **Пробелы**: Нет threat intelligence, email алертов или интеграции с тикетной системой

### После Phase 1 (Продакшен MVP)
- **Позиционирование**: "Готовая к продакшену SIEM для Windows инфраструктуры"
- **Целевой рынок**: Российские предприятия, банки, финансовые институты
- **Ключевые функции**:
  - Полный рабочий процесс инцидентов с тикетами FreeScout
  - Обогащение threat intelligence
  - Email оповещения для критических инцидентов
  - GeoIP-обогащённый анализ событий
- **Конкуренты**: Wazuh (бесплатный), AlienVault OSSIM (бесплатный)
- **Преимущества**: AI анализ, интеграция с FreeScout, соответствие ЦБ РФ, быстрая установка

### После Phase 2 (Автоматизация)
- **Позиционирование**: "Автоматизированная SIEM со встроенным SOAR для Windows"
- **Целевой рынок**: SOC команды, MSSP
- **Ключевые функции**:
  - SOAR playbooks для автоматизированного реагирования
  - Мониторинг целостности файлов (FIM)
  - Запланированные отчёты комплаенса
  - Расширенный поиск и сохранённые запросы
- **Конкуренты**: Wazuh, Security Onion (бесплатные), Splunk (платный)
- **Преимущества**: Экономичный SOAR, оптимизация под Windows, фокус на российский рынок

### После Phase 3-4 (Корпоративный уровень)
- **Позиционирование**: "Корпоративная SIEM с AI, UEBA и SOAR"
- **Целевой рынок**: Крупные предприятия, MSSP провайдеры
- **Ключевые функции**:
  - Поведенческая аналитика пользователей (UEBA)
  - Корреляция с уязвимостями
  - Графовая визуализация для поиска угроз
  - Мультиарендность для сервис-провайдеров
- **Конкуренты**: Splunk Enterprise, IBM QRadar, Elastic Security
- **Преимущества**: 1/10 стоимости, AI-powered, соответствие ЦБ РФ, экспертиза Windows

---

## Быстрые победы (Реализовать первыми - Phase 1)

### Неделя 1: Критическая инфраструктура

1. **Установщик в один клик** - **ВЫПОЛНЕНО**
   - Bash скрипт (install.sh)
   - PowerShell скрипт (install.ps1)
   - Автоустановка Docker, Git
   - Интерактивный мастер
   - Настройка systemd/scheduled task

2. **Email уведомления** (2 дня)
   - Конфигурация SMTP в backend/config
   - Email шаблоны (Jinja2)
   - Email критических алертов (severity >= 3)
   - Email создания/обновления инцидентов
   - Ежедневные дайджесты
   - Тест: Отправка email при новом критическом алерте

3. **Интеграция с FreeScout** (3 дня)
   - FreeScout API клиент (Python)
   - Автосоздание тикета из алерта/инцидента
   - Webhook получатель для обновлений FreeScout
   - Двусторонняя синхронизация статуса
   - Отслеживание переписки в SIEM
   - Тест: Алерт → Тикет → Решён → Обновление SIEM

### Неделя 2: Обогащение и разведка

4. **GeoIP обогащение** (1 день)
   - Загрузка базы MaxMind GeoLite2
   - Обогащение IP → Страна/Город/ASN
   - Виджет карты мира на дашборде
   - Флаги стран в таблице событий
   - Тест: Российский IP показывает местоположение Москва

5. **Интеграция с VirusTotal** (2 дня)
   - Конфигурация API ключа
   - Поиск хэшей файлов для подозрительных процессов
   - Проверка репутации IP/Домена
   - Rate limiting (4 запроса/минуту для бесплатного тарифа)
   - Кэширование результатов на 24 часа
   - Тест: Хэш Mimikatz → обнаружение вредоносного ПО

6. **Интеграция с AbuseIPDB** (1 день)
   - Конфигурация API ключа
   - Поиск репутации IP
   - Обогащение abuse score
   - Автоматическая синхронизация blacklist
   - Тест: Известный вредоносный IP → высокий abuse score

### Неделя 3: Улучшения UX

7. **Сохранённые поисковые запросы** (1 день)
   - Сохранение конфигураций фильтров (События, Алерты, Инциденты)
   - Шаринг поисков между пользователями
   - Быстрый доступ в сайдбаре
   - Экспорт/импорт поисков
   - Тест: Сохранить поиск "Критические события Windows"

**Общее время реализации**: 10 рабочих дней (2-3 недели для 1-2 разработчиков)

**Порядок приоритета**: Email → FreeScout → Threat Intel → GeoIP → Сохранённые поиски

---

## Метрики и критерии успеха

### Текущие метрики (оценочно)
- Время установки: **4-6 часов** (вручную)
- Покрытие платформ: **33%** (только Windows)
- Уровень ложных срабатываний: **Неизвестно** (нет обогащения)
- MTTR: **Вручную** (нет автоматизации)
- Усталость от алертов: **Высокая** (нет снижения шума)

### Целевые метрики (После Phase 1-2)
- Время установки: **< 30 минут** (автоматизировано)
- Покрытие платформ: **90%** (Windows, Linux, macOS)
- Уровень ложных срабатываний: **< 5%** (с обогащением)
- MTTR: **< 15 минут** (с playbooks)
- Усталость от алертов: **Низкая** (с корреляцией)

---

## Возможности для инноваций

### Уникальные отличия (Нет в других SIEM)
1. **Интеграция DeepSeek AI** - Бесплатный, мощный AI анализ
2. **Соответствие ЦБ РФ** - Российские регуляции "из коробки"
3. **Нулевая стоимость лицензий** - Полностью open-source
4. **Современный технологический стек** - React + FastAPI + TimescaleDB
5. **5-минутная установка** - Самое быстрое развёртывание на рынке

### Будущие инновации
- **AI-генерируемые Playbooks** - Автосоздание рабочих процессов реагирования
- **Запросы на естественном языке** - "Покажи все brute force атаки сегодня"
- **Предиктивная аналитика** - "Вероятно вас атакуют через 2 часа"
- **Автономное реагирование** - AI решает лучшее действие реагирования
- **Блокчейн для доказательств** - Неизменяемый журнал аудита

---

## Заключение

Наша SIEM система имеет прочную основу с сильным управлением инцидентами и AI возможностями. Для конкуренции с коммерческими решениями необходимо приоритизировать:

1. **Простая установка** - Убрать барьеры развёртывания
2. **Мультиплатформенная поддержка** - Расшириться за пределы Windows
3. **Threat Intelligence** - Добавить контекст к событиям
4. **Автоматизация** - Снизить ручную работу
5. **Email уведомления** - Не пропускать критические алерты

**Следующие шаги**: Реализовать Phase 1 (Продакшен MVP) в следующем спринте.

---

**Версия документа**: 1.0
**Последнее обновление**: 2025-12-05
**Автор**: Команда разработки SIEM
